---
layout: post
title: "스토리지와 RAID 아키텍처"
date: 2025-03-29 14:40:00 +0000
categories: [infrastructure]
tags: [storage, raid, lvm, infrastructure, tech]
excerpt: "RAID 구성과 LVM을 활용한 스토리지 아키텍처 설계 방법을 알아보겠습니다."
notion_id: 1c5eef64-a1ca-80f3-8a10-fb5421b246ac
notion_url: https://www.notion.so/RAID-1c5eef64a1ca80f38a10fb5421b246ac
---

# 스토리지와 RAID 아키텍처

# 스토리지

## PD (Physical Disk)

- 실제 물리 저장 장치 (하드 디스크, SSD)
## PV (Physical Volume)

<!--more-->

- 물리적 디스크를 LVM(Logical Volume Manager)에서 사용할 수 있도록 초기화한 것
- 디스크나 디스크의 파티션에 PV 설정 가능
## VG (Volume Group)

- 하나 이상의 PV를 모아서 만든 스토리지 풀
- 논리적 볼륨을 할당할 수 있는 공간 제공
## LV (Logical Volume)

- 볼륨 그룹에서 할당된 공간
- 파일시스템을 마운트하고, 실제로 사용하는 단위
- 원하는 만큼 크기 조절 가능
- `/dev/xda1`
## 관계 흐름

PD -> PV -> VG -> LV -> 파일시스템

## 명령어

### 1. 물리 디스크 확인

```shell
lsblk
fdisk -l
```

### 2. 물리 볼륨(PV) 생성

```shell
pvcreate /dev/sdb
pvdisplay
```

### 3. 볼륨 그룹(VG) 생성

```shell
vgcreate vg_name /dev/sdb
vgextend vg_name /dev/sdc  # 추가 PV를 VG에 포함
vgdisplay
```

### 4. 논리적 볼륨(LV) 생성

```shell
lvcreate -n lv_name -L 10G vg_name
lvdisplay
```

### 5. 파일시스템 생성 및 마운트

```plain text
mkfs.ext4 /dev/vg_name/lv_name
mount /dev/vg_name/lv_name /mnt/mount_point
```

- LV의 크기는 필요에 따라 확장/축소 가능 -> EBS 볼륨 조절하듯
- VG를 통해 여러 PD를 하나의 논리적 공간으로 관리
- LV의 특정 시점 스냅샷 생성 가능
- 스트라이핑/미러링: 데이터 성능/안정성을 위한 옵션 제공
## 파일시스템과 마운트

### 파일시스템

- 저장 장치에 데이터를 저장하고 관리하는 방법을 정의하는 구조
- 디스크 공간을 어떻게 파일과 디렉토리로 구성할지 결정하는 규칙과 형식
- 예시
### 마운트

- 파일시스템을 운영체제의 디렉토리 트리에 연결하는 과정
### LVM 파일 시스템 생성 및 마운트 과정

1. LV 생성: 디스크 공간을 LV로 할당
1. 파일시스템 생성: LV에 특정 형식(ext4, xfs 등)의 파일시스템 생성
1. 마운트: 생성된 파일 시스템을 디렉토리 트리의 특정 위치(마운트 포인트)에 연결
### 임시 마운트와 영구 마운트

- 임시 마운트: mount 명령어로 수행하며, 시스템 재부팅 시 사라짐
- 영구 마운트: `/etc/fstab` 파일에 설정을 추가하여 시스템 부팅 시 자동으로 마운트되게 함
### 마운트를 사용하는 이유

1. 일관된 디렉토리 구조 유지
1. 보안 및 접근 제어
1. 다양한 파일시스템 지원
1. 동적 관리 가능
---

## RAID(Redundant Array of Independent Disks)

- 여러 개의 물리적 디스크들을 하나의 논리적 디스크처럼 사용하는 기술
- 데이터 안정성과 성능 향상이 목적
### RAID에서의 레벨

- RAID 0: 순수한 스트라이핑 (성능 향상, 중복성 없음)
- RAID 1: 순수한 미러링 (데이터 보호, 성능 향상 미미)
- RAID 5: 스트라이핑 + 패리티 (성능과 안정성, 최소 3개의 디스크로 구성)
- RAID 6: 이중 패리티 (두 개의 독립적인 패리티 블록 사용)
- RAID 10: 미러링 + 스트라이핑 (높은 성능과 안정성, 비용 높음)
---

# Striping, Mirroring

RAID 기술에서 유래한 데이터 저장 방식으로, LVM(Logical Volume Manager)에서 이런 기능 제공

## Striping

- 데이터를 여러 물리적 디스크에 균일하게 분산하여 저장
- 각 디스크에 순차적으로 데이터 조각(stripes)을 나누어 저장
### 장점

1. 성능 향상: 여러 디스크에 동시에 읽기/쓰기가 가능하여 I/O 속도가 크게 개선됨
1. 대역폭 증가: 병렬 처리로 데이터 전송 속도가 증가함
### 단점

1. 데이터 안정성 감소: 하나의 디스크가 고장나면 전체 데이터 손실
1. 복구 불가: 단독으로는 복구 불가능
### 예시

```shell
lvcreate -n striped_lv -L 10G -i 2 -I 64 vg_name
```

- `i 2`: 2개의 디스크에 스트라이핑
- `I 64`: 스트라이프 크기를 64KB로 설정
## Mirroring

- 동일한 데이터를 여러 물리적 디스크에 중복해서 저장
### 예시

```shell
lvcreate -n mirrored_lv -L 10G -m 1 vg_name
```

- `m 1`: 미러 사본 1개 생성 (총 2개의 복사본)

---

*Originally published in [Notion](https://www.notion.so/RAID-1c5eef64a1ca80f38a10fb5421b246ac) on March 29, 2025*